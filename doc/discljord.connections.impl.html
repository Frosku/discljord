<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>discljord.connections.impl documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Discljord</span> <span class="project-version">0.2.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>discljord</span></div></div></li><li class="depth-2"><a href="discljord.connections.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>connections</span></div></a></li><li class="depth-3 branch current"><a href="discljord.connections.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li><li class="depth-3"><a href="discljord.connections.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2 branch"><a href="discljord.events.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch"><a href="discljord.http.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-2"><a href="discljord.messaging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>messaging</span></div></a></li><li class="depth-3 branch"><a href="discljord.messaging.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li><li class="depth-3"><a href="discljord.messaging.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2 branch"><a href="discljord.specs.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2"><a href="discljord.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="discljord.connections.impl.html#var-connect-shard.21"><div class="inner"><span>connect-shard!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-connect-shards.21"><div class="inner"><span>connect-shards!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-get-shard-from-guild"><div class="inner"><span>get-shard-from-guild</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-get-websocket-gateway.21"><div class="inner"><span>get-websocket-gateway!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-handle-command.21"><div class="inner"><span>handle-command!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-handle-disconnect.21"><div class="inner"><span>handle-disconnect!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-handle-event"><div class="inner"><span>handle-event</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-handle-payload.21"><div class="inner"><span>handle-payload!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-handle-websocket-event.21"><div class="inner"><span>handle-websocket-event!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-reconnect-websocket.21"><div class="inner"><span>reconnect-websocket!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-start-communication-loop.21"><div class="inner"><span>start-communication-loop!</span></div></a></li><li class="depth-1"><a href="discljord.connections.impl.html#var-start-event-loop.21"><div class="inner"><span>start-event-loop!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">discljord.connections.impl</h1><div class="doc"><pre class="plaintext">Implementation namespace for `discljord.connections`.
</pre></div><div class="public anchor" id="var-connect-shard.21"><h3>connect-shard!</h3><div class="usage"><code>(connect-shard! url token shard-id shard-count out-ch comm-ch &amp; {:keys [buffer-size]})</code></div><div class="doc"><pre class="plaintext">Takes a gateway URL and a bot token, creates a websocket connected to
Discord's servers, and returns a function of no arguments which disconnects it</pre></div></div><div class="public anchor" id="var-connect-shards.21"><h3>connect-shards!</h3><div class="usage"><code>(connect-shards! url token shard-count out-ch comm-ch &amp; {:keys [buffer-size]})</code></div><div class="doc"><pre class="plaintext">Calls connect-shard! once per shard in shard-count, and returns a sequence
of promises of the return results.</pre></div></div><div class="public anchor" id="var-get-shard-from-guild"><h3>get-shard-from-guild</h3><div class="usage"><code>(get-shard-from-guild guild-id guild-count)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-get-websocket-gateway.21"><h3>get-websocket-gateway!</h3><div class="usage"><code>(get-websocket-gateway! url token)</code></div><div class="doc"><pre class="plaintext">Gets the shard count and websocket endpoint from Discord's API.
</pre></div></div><div class="public anchor" id="var-handle-command.21"><h3>handle-command!</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Handles commands from the outside world.

Takes an atom of a vector of promises containing atoms of shard connections,
the channel used to send events out of the process, a keyword command type,
and any number of command data arguments.</pre></div></div><div class="public anchor" id="var-handle-disconnect.21"><h3>handle-disconnect!</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Handles the disconnection process for different stop codes.

Takes an integer stop code, the message, a function to reconnect
the shard, and a function to reconnect the shard with resume.</pre></div></div><div class="public anchor" id="var-handle-event"><h3>handle-event</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Handles event payloads sent from Discord in the context of the connection,
before it gets to the regular event handlers.

Takes a keyword event type, event data from Discord, an atom containing the shard's
state, and the channel for sending events out of the process.</pre></div></div><div class="public anchor" id="var-handle-payload.21"><h3>handle-payload!</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Handles a command payload sent from Discord.

Takes an integer op code, the data sent from Discord, a function to reconnect
the shard to Discord, a function to reconnect to Discord with a resume,
a function to send a heartbeat to Discord, an atom containing the ack state
from the last heartbeat, an atom containing whether the current shard is connected,
and an atom containing the shard state, including the seq and session-id.</pre></div></div><div class="public anchor" id="var-handle-websocket-event.21"><h3>handle-websocket-event!</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Handles events sent from discord over the websocket.

Takes the channel to send events out of the process, a
keyword event type, and any number of event data arguments.</pre></div></div><div class="public anchor" id="var-reconnect-websocket.21"><h3>reconnect-websocket!</h3><div class="usage"><code>(reconnect-websocket! url token conn ch shard out-ch &amp; {:keys [init-shard-state buffer-size]})</code></div><div class="doc"><pre class="plaintext">Takes a websocket connection atom and additional connection information,
and reconnects a websocket, with options for resume or not.</pre></div></div><div class="public anchor" id="var-start-communication-loop.21"><h3>start-communication-loop!</h3><div class="usage"><code>(start-communication-loop! shards token ch out-ch comm-ch)</code></div><div class="doc"><pre class="plaintext">Takes a vector of promises representing the atoms of websocket connections of the shards.
</pre></div></div><div class="public anchor" id="var-start-event-loop.21"><h3>start-event-loop!</h3><div class="usage"><code>(start-event-loop! conn ch out-ch comm-ch)</code></div><div class="doc"><pre class="plaintext">Starts a go loop which takes events from the channel and dispatches them
via multimethod.</pre></div></div></div></body></html>